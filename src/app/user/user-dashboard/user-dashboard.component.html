<!--
  @fileoverview User Dashboard Template
  @description Main dashboard view for users showing meal info, QR code generation, and history
  
  CHANGES MADE:
  - Resolved Git merge conflict (kept HEAD version as both were identical)
  - Removed commented-out sidebar code (now handled in app.component.html)
  - Added documentation comments
-->

<div class="main-content">
  <div class="container">
    <!-- Welcome Card - Displays user information -->
    <mat-card class="welcome-card">
      <h2 class="welcome-text">Welcome Back, {{ userDetails?.username }}</h2>
      <p class="details">Matric Number: {{ userDetails?.matricNumber }}</p>
      <p class="details">Meal Plan: {{ mealPlan }}</p>
    </mat-card>
  
    <!-- Stats Grid - Displays meal statistics -->
    <div class="stats-grid">
      <mat-card class="stat-card">
        <h3>Meals Left</h3>
        <p class="number">{{ mealsLeft }}</p>
      </mat-card>
      <mat-card class="stat-card">
        <h3>Meals Used</h3>
        <p class="trend">{{ mealsUsed }}</p>
      </mat-card>
    </div>
  
    <!-- QR Code Generation Button -->
    <div class="qr-button-container">
      <button mat-flat-button class="qr-button" (click)="toggleQRCode()">
        <mat-icon class="qr-icon">qr_code</mat-icon> Generate QR Code
      </button>
    </div>
    
    <!-- QR Code Display Component (Conditionally rendered) -->
    <app-qr-generation *ngIf="showQRCode" [userData]="qrData"></app-qr-generation>
  
    <!-- Meal History Card -->
    <mat-card class="history-card">
      <h3 class="meal-history-title">Meal History</h3>
      <div class="history-list">
        <mat-list class="meal-history-list">
          <mat-list-item *ngFor="let meal of getLatestMealHistory()">
            <div class="list-content">
              <p class="qr-title">{{ meal.mealType | titlecase }}</p>
              <p class="qr-date">Consumed on {{ meal.dateConsumed | date:'medium' }}</p>
            </div>
            <mat-icon class="history-icon">history</mat-icon>
          </mat-list-item>
        </mat-list>
      </div>
      <!-- View More Button - Links to full history -->
      <button mat-button class="view-more-btn" [routerLink]="'/qr-history'" [queryParams]="{ userId: userDetails?.id }">
        View More
      </button>
    </mat-card>
  </div>
</div>
